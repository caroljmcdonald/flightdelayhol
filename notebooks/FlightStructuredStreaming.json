{"paragraphs":[{"text":"%md \n## Streaming Data\nMapR Event Store is a distributed publish-subscribe event streaming system that enables producers and consumers to exchange events in real time in a parallel and fault-tolerant manner via the Apache Kafka API.\nA stream represents a continuous sequence of events that goes from producers to consumers, where an event is defined as a key-value pair.\n<img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image29.png\">\nThe Streaming event values have the following format:\n\n{\"id\":\"ATL_BOS_2018-01-01_DL_104\",\"fldate\":\"2018-01-01\",\"month\":1,\"dofW\":1,\n\"carrier\":\"DL\",\"src\":\"ATL\",\"dst\":\"BOS\",\"crsdephour\":9,\"crsdeptime\":850,\"depdelay\":0.0,\n\"crsarrtime\":1116,\"arrdelay\":0.0,\"crselapsedtime\":146.0,\"dist\":946.0}\n\nWe will use the machine learning model to enrich the events with the flight delay label and predictions and we will store the results in MapR Database. \n\n<img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image46.png\">","user":"anonymous","dateUpdated":"2019-03-07T18:43:40+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Streaming Data</h2>\n<p>MapR Event Store is a distributed publish-subscribe event streaming system that enables producers and consumers to exchange events in real time in a parallel and fault-tolerant manner via the Apache Kafka API.<br/>A stream represents a continuous sequence of events that goes from producers to consumers, where an event is defined as a key-value pair.<br/><img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image29.png\"><br/>The Streaming event values have the following format:</p>\n<p>{&ldquo;id&rdquo;:&ldquo;ATL_BOS_2018-01-01_DL_104&rdquo;,&ldquo;fldate&rdquo;:&ldquo;2018-01-01&rdquo;,&ldquo;month&rdquo;:1,&ldquo;dofW&rdquo;:1,<br/>&ldquo;carrier&rdquo;:&ldquo;DL&rdquo;,&ldquo;src&rdquo;:&ldquo;ATL&rdquo;,&ldquo;dst&rdquo;:&ldquo;BOS&rdquo;,&ldquo;crsdephour&rdquo;:9,&ldquo;crsdeptime&rdquo;:850,&ldquo;depdelay&rdquo;:0.0,<br/>&ldquo;crsarrtime&rdquo;:1116,&ldquo;arrdelay&rdquo;:0.0,&ldquo;crselapsedtime&rdquo;:146.0,&ldquo;dist&rdquo;:946.0}</p>\n<p>We will use the machine learning model to enrich the events with the flight delay label and predictions and we will store the results in MapR Database. </p>\n<img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image46.png\">\n</div>"}]},"apps":[],"jobName":"paragraph_1551984220177_-976894637","id":"20170530-122945_1594214131","dateCreated":"2019-03-07T18:43:40+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:13495"},{"text":"%md\n## Spark Structured Streaming\n\nStructured Streaming is a scalable and fault-tolerant stream processing engine built on the Spark SQL engine. Structured Streaming enables you to view data published to Kafka as an unbounded DataFrame and process this data with the same DataFrame, Dataset, and SQL APIs used for batch processing.\n<img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image25.png\">","user":"anonymous","dateUpdated":"2019-03-07T18:43:40+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Spark Structured Streaming</h2>\n<p>Structured Streaming is a scalable and fault-tolerant stream processing engine built on the Spark SQL engine. Structured Streaming enables you to view data published to Kafka as an unbounded DataFrame and process this data with the same DataFrame, Dataset, and SQL APIs used for batch processing.<br/><img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image25.png\"></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1551984220180_1817055156","id":"20190220-173254_1728425170","dateCreated":"2019-03-07T18:43:40+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13496"},{"title":"Import needed packages","text":"%spark\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql._\nimport org.apache.spark.streaming._\n\nimport org.apache.spark.ml._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.evaluation._\nimport org.apache.spark.ml.tuning._\n","user":"anonymous","dateUpdated":"2019-03-07T18:53:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql._\nimport org.apache.spark.streaming._\nimport org.apache.spark.ml._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.evaluation._\nimport org.apache.spark.ml.tuning._\n"}]},"apps":[],"jobName":"paragraph_1551984220181_-2140745666","id":"20170508-144514_403247535","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13497","dateFinished":"2019-03-07T18:53:36+0000","dateStarted":"2019-03-07T18:53:35+0000"},{"text":"%spark\ncase class Flight(id: String, fldate: String, month: Integer, dofW: Integer, carrier: String,src: String, dst: String, crsdephour: Integer, crsdeptime: Integer,depdelay: Double, crsarrtime: Integer, arrdelay: Double, crselapsedtime:Double, dist: Double, orig_dest: String, label: Double, prediction: Double)","user":"anonymous","dateUpdated":"2019-03-07T18:53:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"defined class Flight\n"}]},"apps":[],"jobName":"paragraph_1551984220181_-2100052107","id":"20190307-174353_809383666","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13498","dateFinished":"2019-03-07T18:53:45+0000","dateStarted":"2019-03-07T18:53:45+0000"},{"title":"Define Schema for JSON streaming data","text":"\nimport org.apache.spark.sql.types._\n\n// {“id”:“ATL_BOS_2018-01-01_DL_104”,“fldate”:“2018-01-01”,“month”:1,“dofW”:1,\n//“carrier”:“DL”,“src”:“ATL”,“dst”:“BOS”,“crsdephour”:9,“crsdeptime”:850,“depdelay”:0.0,\n//“crsarrtime”:1116,“arrdelay”:0.0,“crselapsedtime”:146.0,“dist”:946.0}\n\n  val schema = StructType(Array(\n    StructField(\"id\", StringType, true),\n    StructField(\"fldate\", StringType, true),\n    StructField(\"month\", IntegerType, true),\n    StructField(\"dofW\", IntegerType, true),\n    StructField(\"carrier\", StringType, true),\n    StructField(\"src\", StringType, true),\n    StructField(\"dst\", StringType, true),\n    StructField(\"crsdephour\", IntegerType, true),\n    StructField(\"crsdeptime\", IntegerType, true),\n    StructField(\"depdelay\", DoubleType, true),\n    StructField(\"crsarrtime\", IntegerType, true),\n    StructField(\"arrdelay\", DoubleType, true),\n    StructField(\"crselapsedtime\", DoubleType, true),\n    StructField(\"dist\", DoubleType, true)\n  ))\n   ","user":"anonymous","dateUpdated":"2019-03-07T18:53:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(id,StringType,true), StructField(fldate,StringType,true), StructField(month,IntegerType,true), StructField(dofW,IntegerType,true), StructField(carrier,StringType,true), StructField(src,StringType,true), StructField(dst,StringType,true), StructField(crsdephour,IntegerType,true), StructField(crsdeptime,IntegerType,true), StructField(depdelay,DoubleType,true), StructField(crsarrtime,IntegerType,true), StructField(arrdelay,DoubleType,true), StructField(crselapsedtime,DoubleType,true), StructField(dist,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1551984220181_-735873935","id":"20170508-150032_326029627","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13499","dateFinished":"2019-03-07T18:53:50+0000","dateStarted":"2019-03-07T18:53:50+0000"},{"title":"Define Topic , Table , and Model Directory","text":"// MapR Event Store for Kafka Topic to read from \nvar topic: String = \"/user/mapr/stream:flights\"\n// MapR Database table to write to \nvar tableName: String = \"/user/mapr/flighttable\"\n// Directory to read the saved ML model from \nvar modeldirectory =\"/user/mapr/model/\"\n","user":"anonymous","dateUpdated":"2019-03-07T18:54:01+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"topic: String = /user/mapr/stream:flights\ntableName: String = /user/mapr/flighttable\nmodeldirectory: String = /user/mapr/model/\n"}]},"apps":[],"jobName":"paragraph_1551984220182_437475376","id":"20170508-150131_378637203","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13500","dateFinished":"2019-03-07T18:54:02+0000","dateStarted":"2019-03-07T18:54:01+0000"},{"title":"Read the saved Machine Learning Model","text":"import spark.implicits._\nval model = org.apache.spark.ml.PipelineModel.load(modeldirectory)","user":"anonymous","dateUpdated":"2019-03-07T18:54:08+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nmodel: org.apache.spark.ml.PipelineModel = pipeline_68b4d25e1c79\n"}]},"apps":[],"jobName":"paragraph_1551984220182_1723738221","id":"20171129-221736_959969733","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13501","dateFinished":"2019-03-07T18:54:13+0000","dateStarted":"2019-03-07T18:54:08+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=66","http://6eb9f2b30c98:4040/jobs/job?id=67","http://6eb9f2b30c98:4040/jobs/job?id=68","http://6eb9f2b30c98:4040/jobs/job?id=69","http://6eb9f2b30c98:4040/jobs/job?id=70","http://6eb9f2b30c98:4040/jobs/job?id=71","http://6eb9f2b30c98:4040/jobs/job?id=72","http://6eb9f2b30c98:4040/jobs/job?id=73","http://6eb9f2b30c98:4040/jobs/job?id=74","http://6eb9f2b30c98:4040/jobs/job?id=75","http://6eb9f2b30c98:4040/jobs/job?id=76","http://6eb9f2b30c98:4040/jobs/job?id=77","http://6eb9f2b30c98:4040/jobs/job?id=78","http://6eb9f2b30c98:4040/jobs/job?id=79","http://6eb9f2b30c98:4040/jobs/job?id=80","http://6eb9f2b30c98:4040/jobs/job?id=81","http://6eb9f2b30c98:4040/jobs/job?id=82","http://6eb9f2b30c98:4040/jobs/job?id=83","http://6eb9f2b30c98:4040/jobs/job?id=84","http://6eb9f2b30c98:4040/jobs/job?id=85","http://6eb9f2b30c98:4040/jobs/job?id=86","http://6eb9f2b30c98:4040/jobs/job?id=87","http://6eb9f2b30c98:4040/jobs/job?id=88","http://6eb9f2b30c98:4040/jobs/job?id=89","http://6eb9f2b30c98:4040/jobs/job?id=90","http://6eb9f2b30c98:4040/jobs/job?id=91","http://6eb9f2b30c98:4040/jobs/job?id=92","http://6eb9f2b30c98:4040/jobs/job?id=93","http://6eb9f2b30c98:4040/jobs/job?id=94","http://6eb9f2b30c98:4040/jobs/job?id=95","http://6eb9f2b30c98:4040/jobs/job?id=96","http://6eb9f2b30c98:4040/jobs/job?id=97","http://6eb9f2b30c98:4040/jobs/job?id=98"],"interpreterSettingId":"spark"}}},{"text":"// Print out the model feature importances\n val featureCols = Array(\"carrierIndexed\", \"dstIndexed\", \"srcIndexed\", \"dofWIndexed\", \"orig_destIndexed\", \"crsdephour\", \"crsdeptime\", \"crsarrtime\", \"crselapsedtime\", \"dist\")\nval rfm = model.stages.last.asInstanceOf[RandomForestClassificationModel]\nval featureImportances =rfm.featureImportances\nfeatureCols.zip(featureImportances.toArray).sortBy(-_._2).foreach { case (feat, imp) => println(s\"feature: $feat, importance: $imp\") }\n","user":"anonymous","dateUpdated":"2019-03-07T18:54:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"feature: crsdeptime, importance: 0.28351763249788353\nfeature: orig_destIndexed, importance: 0.19366046264846604\nfeature: crsarrtime, importance: 0.18539901941274597\nfeature: crsdephour, importance: 0.11189215100129155\nfeature: dofWIndexed, importance: 0.06079935925478266\nfeature: crselapsedtime, importance: 0.05199848773217375\nfeature: srcIndexed, importance: 0.041716384518939956\nfeature: dstIndexed, importance: 0.03598083086117173\nfeature: dist, importance: 0.019475337697743626\nfeature: carrierIndexed, importance: 0.01556033437480119\nfeatureCols: Array[String] = Array(carrierIndexed, dstIndexed, srcIndexed, dofWIndexed, orig_destIndexed, crsdephour, crsdeptime, crsarrtime, crselapsedtime, dist)\nrfm: org.apache.spark.ml.classification.RandomForestClassificationModel = RandomForestClassificationModel (uid=rfc_13116ad261f9) with 10 trees\nfeatureImportances: org.apache.spark.ml.linalg.Vector = (10,[0,1,2,3,4,5,6,7,8,9],[0.01556033437480119,0.03598083086117173,0.041716384518939956,0.06079935925478266,0.19366046264846604,0.11189215100129155,0.28351763249788353,0.18539901941274597,0.05199848773217375,0.019475337697743626])\n"}]},"apps":[],"jobName":"paragraph_1551984220182_-1450306783","id":"20190307-173159_764062524","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13502","dateFinished":"2019-03-07T18:54:16+0000","dateStarted":"2019-03-07T18:54:15+0000"},{"text":"%md\n## Reading Data from Kafka Topics\nIn order to read from Kafka, we must first specify the stream format, topic, and offset options.For more information on the configuration parameters","user":"anonymous","dateUpdated":"2019-03-07T18:43:40+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Reading Data from Kafka Topics</h2>\n<p>In order to read from Kafka, we must first specify the stream format, topic, and offset options.For more information on the configuration parameters</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1551984220183_-998994641","id":"20190306-165333_491584061","dateCreated":"2019-03-07T18:43:40+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13503"},{"title":"Read Stream from Kafka topic ","text":"// read stream from Kafka\nval df1 = spark.readStream.format(\"kafka\").option(\"kafka.bootstrap.servers\", \"maprdemo:9092\").option(\"subscribe\", topic).option(\"group.id\", \"testgroup\").option(\"startingOffsets\", \"earliest\").option(\"failOnDataLoss\", false).option(\"maxOffsetsPerTrigger\", 1000).load()","user":"anonymous","dateUpdated":"2019-03-07T18:54:46+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [key: binary, value: binary ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551984220183_870779584","id":"20190306-002931_1225657206","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13504","dateFinished":"2019-03-07T18:54:47+0000","dateStarted":"2019-03-07T18:54:46+0000"},{"title":"Print DataFrame Schema","text":"// readStream.format \"kafka\" returns a DataFrame with the following schema:\ndf1.printSchema","user":"anonymous","dateUpdated":"2019-03-07T18:54:52+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- key: binary (nullable = true)\n |-- value: binary (nullable = true)\n |-- topic: string (nullable = true)\n |-- partition: integer (nullable = true)\n |-- offset: long (nullable = true)\n |-- timestamp: timestamp (nullable = true)\n |-- timestampType: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1551984220183_515010853","id":"20171129-223643_463511351","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13505","dateFinished":"2019-03-07T18:54:52+0000","dateStarted":"2019-03-07T18:54:52+0000"},{"text":"%md\nThe next step is to parse and transform the binary values column into a Dataset of Flight schema.\nIn the code below: \n* first we use a select expression with a String Cast of the df1 column value to convert the value from binary to string\n* then we use the from_json Spark SQL function in a select expression to retrieve the JSON string as the specified schema StructTyp\n","user":"anonymous","dateUpdated":"2019-03-07T18:43:40+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The next step is to parse and transform the binary values column into a Dataset of Flight schema.<br/>In the code below:<br/>* first we use a select expression with a String Cast of the df1 column value to convert the value from binary to string<br/>* then we use the from_json Spark SQL function in a select expression to retrieve the JSON string as the specified schema StructTyp</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1551984220184_-131592598","id":"20190306-165945_2131987408","dateCreated":"2019-03-07T18:43:40+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13506"},{"title":"Parse the Message Values into a Dataframe of Flight Schema","text":"// cast the df1 column value to string\n// use the from_json function to convert value JSON string to flight schema\nval df2 = df1.select($\"value\" cast \"string\" as \"json\").select(from_json($\"json\", schema) as \"data\").select(\"data.*\")","user":"anonymous","dateUpdated":"2019-03-07T18:55:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 12 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551984220184_1699181864","id":"20190306-003118_1790885997","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13507","dateFinished":"2019-03-07T18:55:01+0000","dateStarted":"2019-03-07T18:55:00+0000"},{"text":" // add column orig_dest, needed feature for ML model\n val df3 = df2.withColumn(\"orig_dest\", concat($\"src\", lit(\"_\"), $\"dst\"))","user":"anonymous","dateUpdated":"2019-03-07T18:55:06+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df3: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551984220185_-1497857800","id":"20190306-010238_1100520892","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13508","dateFinished":"2019-03-07T18:55:07+0000","dateStarted":"2019-03-07T18:55:06+0000"},{"text":"%md\n## Enriching the flight Dataframe with label and predictions\nWe transform the DataFrame with the model pipeline, which will tranform the features according to the pipeline, estimate and then return the predictions in a column of a new DateFrame.","user":"anonymous","dateUpdated":"2019-03-07T18:43:40+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Enriching the flight Dataframe with label and predictions</h2>\n<p>We transform the DataFrame with the model pipeline, which will tranform the features according to the pipeline, estimate and then return the predictions in a column of a new DateFrame.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1551984220185_79841494","id":"20190306-171339_1154203095","dateCreated":"2019-03-07T18:43:40+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13509"},{"text":"// transform the DataFrame with the model pipeline, which will tranform the features according to the pipeline, \n// estimate and then return the predictions in a column of a new DateFrame\nval predictions = model.transform(df3)","user":"anonymous","dateUpdated":"2019-03-07T18:55:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"predictions: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551984220185_-714328037","id":"20190306-010315_921932660","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13510","dateFinished":"2019-03-07T18:55:13+0000","dateStarted":"2019-03-07T18:55:12+0000"},{"text":"\n// select the columns that we want to store\nval lp = predictions.select($\"id\",$\"fldate\", $\"month\", $\"dofW\", $\"carrier\", $\"src\", $\"dst\", $\"crsdephour\", $\"crsdeptime\", $\"depdelay\", $\"crsarrtime\",$\"arrdelay\", $\"crselapsedtime\",$\"dist\", $\"orig_dest\", $\"label\", $\"prediction\").as[Flight]","user":"anonymous","dateUpdated":"2019-03-07T18:55:20+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lp: org.apache.spark.sql.Dataset[Flight] = [id: string, fldate: string ... 15 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551984220186_1019121577","id":"20190306-010344_1169277532","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13511","dateFinished":"2019-03-07T18:55:21+0000","dateStarted":"2019-03-07T18:55:20+0000"},{"text":"// define new schema with label and prediction\nval schema2 = StructType(Array(\n    StructField(\"id\", StringType, true),\n    StructField(\"fldate\", StringType, true),\n    StructField(\"month\", IntegerType, true),\n    StructField(\"dofW\", IntegerType, true),\n    StructField(\"carrier\", StringType, true),\n    StructField(\"src\", StringType, true),\n    StructField(\"dst\", StringType, true),\n    StructField(\"crsdephour\", IntegerType, true),\n    StructField(\"crsdeptime\", IntegerType, true),\n    StructField(\"depdelay\", DoubleType, true),\n    StructField(\"crsarrtime\", IntegerType, true),\n    StructField(\"arrdelay\", DoubleType, true),\n    StructField(\"crselapsedtime\", DoubleType, true),\n    StructField(\"dist\", DoubleType, true),\n    StructField(\"orig_dest\", StringType, true),\n    StructField(\"label\", DoubleType, true),\n    StructField(\"prediction\", DoubleType, true)\n  ))","user":"anonymous","dateUpdated":"2019-03-07T18:55:37+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schema2: org.apache.spark.sql.types.StructType = StructType(StructField(id,StringType,true), StructField(fldate,StringType,true), StructField(month,IntegerType,true), StructField(dofW,IntegerType,true), StructField(carrier,StringType,true), StructField(src,StringType,true), StructField(dst,StringType,true), StructField(crsdephour,IntegerType,true), StructField(crsdeptime,IntegerType,true), StructField(depdelay,DoubleType,true), StructField(crsarrtime,IntegerType,true), StructField(arrdelay,DoubleType,true), StructField(crselapsedtime,DoubleType,true), StructField(dist,DoubleType,true), StructField(orig_dest,StringType,true), StructField(label,DoubleType,true), StructField(prediction,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1551984220186_-1737906434","id":"20190306-211342_1150192494","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13512","dateFinished":"2019-03-07T18:55:37+0000","dateStarted":"2019-03-07T18:55:37+0000"},{"text":"import com.mapr.db.spark.impl._\nimport com.mapr.db.spark.streaming._\nimport com.mapr.db.spark.sql._\nimport com.mapr.db.spark.streaming.MapRDBSourceConfig\n// write stream to MapR-DB \nval writedb = lp.writeStream.format(MapRDBSourceConfig.Format).option(MapRDBSourceConfig.TablePathOption, tableName).option(MapRDBSourceConfig.IdFieldPathOption, \"id\").option(MapRDBSourceConfig.CreateTableOption, false).option(\"checkpointLocation\", \"/tmp/flight\").option(MapRDBSourceConfig.BulkModeOption, true).option(MapRDBSourceConfig.SampleSizeOption, 1000).start()\n\n","user":"anonymous","dateUpdated":"2019-03-07T18:55:56+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.mapr.db.spark.impl._\nimport com.mapr.db.spark.streaming._\nimport com.mapr.db.spark.sql._\nimport com.mapr.db.spark.streaming.MapRDBSourceConfig\nwritedb: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@3a2f7e22\n"}]},"apps":[],"jobName":"paragraph_1551984220186_2059001027","id":"20190306-003127_1670791655","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13513","dateFinished":"2019-03-07T18:55:57+0000","dateStarted":"2019-03-07T18:55:56+0000"},{"text":"import org.apache.spark._\n\nimport com.mapr.db._\nimport com.mapr.db.spark._\nimport com.mapr.db.spark.impl._\nimport com.mapr.db.spark.sql._\n// get spark session to read from MapR -DB \nval spark = org.apache.spark.sql.SparkSession.builder().appName(\"flightread\").getOrCreate()\n","user":"anonymous","dateUpdated":"2019-03-07T18:56:23+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\nimport com.mapr.db._\nimport com.mapr.db.spark._\nimport com.mapr.db.spark.impl._\nimport com.mapr.db.spark.sql._\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@7dff8792\n"}]},"apps":[],"jobName":"paragraph_1551984220187_442899623","id":"20190306-011141_1523714467","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13514","dateFinished":"2019-03-07T18:56:23+0000","dateStarted":"2019-03-07T18:56:23+0000"},{"text":" // load flight dataset from MapR-DB \nval df = spark.sparkSession.loadFromMapRDB(tableName, schema2).as[Flight]\n\ndf.show\n\ndf.createOrReplaceTempView(\"flights\")","user":"anonymous","dateUpdated":"2019-03-07T18:56:34+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+-----+---------+-----+----------+\n|                  id|    fldate|month|dofW|carrier|src|dst|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime| dist|orig_dest|label|prediction|\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+-----+---------+-----+----------+\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|         9|       850|     0.0|      1116|     0.0|         146.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        11|      1122|     8.0|      1349|     0.0|         147.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        14|      1356|     9.0|      1623|     0.0|         147.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        16|      1620|     0.0|      1851|     3.0|         151.0|946.0|  ATL_BOS|  0.0|       1.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        19|      1940|     6.0|      2210|     0.0|         150.0|946.0|  ATL_BOS|  0.0|       1.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        12|      1248|     0.0|      1513|     0.0|         145.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        22|      2215|     0.0|        39|     0.0|         144.0|946.0|  ATL_BOS|  0.0|       1.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        15|      1500|    21.0|      1734|    33.0|         154.0|946.0|  ATL_BOS|  0.0|       1.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     WN|ATL|BOS|        15|      1500|   198.0|      1725|   208.0|         145.0|946.0|  ATL_BOS|  1.0|       1.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     WN|ATL|BOS|        21|      2055|    14.0|      2330|     0.0|         155.0|946.0|  ATL_BOS|  0.0|       1.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     WN|ATL|BOS|        10|      1015|   215.0|      1250|   191.0|         155.0|946.0|  ATL_BOS|  1.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|         9|       850|     9.0|      1116|     0.0|         146.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        11|      1123|     0.0|      1350|     0.0|         147.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        10|      1000|    22.0|      1232|    10.0|         152.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        14|      1356|     6.0|      1623|    21.0|         147.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        22|      2227|     8.0|        51|     0.0|         144.0|946.0|  ATL_BOS|  0.0|       1.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        16|      1620|     0.0|      1851|     0.0|         151.0|946.0|  ATL_BOS|  0.0|       1.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        19|      1940|    62.0|      2210|    50.0|         150.0|946.0|  ATL_BOS|  1.0|       1.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        12|      1248|    15.0|      1513|     7.0|         145.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        21|      2107|    12.0|      2335|    29.0|         148.0|946.0|  ATL_BOS|  0.0|       1.0|\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+-----+---------+-----+----------+\nonly showing top 20 rows\n\ndf: org.apache.spark.sql.Dataset[Flight] = [id: string, fldate: string ... 15 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551984220187_1531743734","id":"20190306-011320_1619042382","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13515","dateFinished":"2019-03-07T18:56:46+0000","dateStarted":"2019-03-07T18:56:34+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=213"],"interpreterSettingId":"spark"}}},{"text":"%md \n# Use Spark SQL to explore the dataset","user":"anonymous","dateUpdated":"2019-03-07T18:43:40+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Use Spark SQL to explore the dataset</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1551984220187_183259837","id":"20170603-182655_1680505289","dateCreated":"2019-03-07T18:43:40+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13516"},{"text":"df.count","user":"anonymous","dateUpdated":"2019-03-07T18:57:02+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res13: Long = 199336\n"}]},"apps":[],"jobName":"paragraph_1551984220188_775115538","id":"20190306-003457_1891238408","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13517","dateFinished":"2019-03-07T18:57:08+0000","dateStarted":"2019-03-07T18:57:02+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=292"],"interpreterSettingId":"spark"}}},{"text":"df.groupBy(\"src\",\"dst\",\"label\",\"prediction\").count.show","user":"anonymous","dateUpdated":"2019-03-07T18:57:13+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+-----+----------+-----+\n|src|dst|label|prediction|count|\n+---+---+-----+----------+-----+\n|CLT|DFW|  0.0|       0.0| 1055|\n|MIA|IAH|  1.0|       1.0|   60|\n|IAH|ORD|  1.0|       1.0|   99|\n|LAX|BOS|  1.0|       0.0|   61|\n|CLT|DEN|  1.0|       1.0|   50|\n|DEN|CLT|  0.0|       0.0|  758|\n|ORD|SFO|  0.0|       1.0| 1622|\n|LAX|SFO|  0.0|       1.0| 1695|\n|SFO|CLT|  1.0|       0.0|   42|\n|LGA|DFW|  0.0|       0.0| 1127|\n|SFO|SEA|  1.0|       1.0|  111|\n|ATL|ORD|  1.0|       1.0|  166|\n|DEN|EWR|  1.0|       0.0|   11|\n|MIA|EWR|  1.0|       1.0|  139|\n|LGA|DFW|  0.0|       1.0|  453|\n|ATL|CLT|  0.0|       0.0| 1977|\n|EWR|DFW|  0.0|       0.0|  626|\n|MIA|DEN|  1.0|       1.0|   19|\n|IAH|SEA|  0.0|       0.0|  517|\n|SEA|SFO|  1.0|       0.0|  102|\n+---+---+-----+----------+-----+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1551984220188_-1551745992","id":"20190307-013831_777164675","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13518","dateFinished":"2019-03-07T18:57:22+0000","dateStarted":"2019-03-07T18:57:13+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=330","http://6eb9f2b30c98:4040/jobs/job?id=355","http://6eb9f2b30c98:4040/jobs/job?id=356"],"interpreterSettingId":"spark"}}},{"title":"Top 5 Longest departure delays","text":"%sql \nselect carrier,src, dst, depdelay,crsdephour, dist, dofW\nfrom flights \norder by depdelay desc limit 5 \n","user":"anonymous","dateUpdated":"2019-03-07T18:58:02+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"carrier":"string","src":"string","dst":"string","depdelay":"string","crsdephour":"string","dist":"string","dofW":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false},"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"src","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tsrc\tdst\tdepdelay\tcrsdephour\tdist\tdofW\nAA\tIAH\tMIA\t1559.0\t11\t964.0\t5\nAA\tIAH\tDFW\t1445.0\t18\t224.0\t3\nAA\tBOS\tDFW\t1345.0\t10\t1562.0\t4\nUA\tBOS\tORD\t1334.0\t9\t867.0\t4\nAA\tLAX\tMIA\t1283.0\t9\t2342.0\t1\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220188_1303912794","id":"20171110-195321_1924356975","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13519","dateFinished":"2019-03-07T18:57:39+0000","dateStarted":"2019-03-07T18:57:28+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=377"],"interpreterSettingId":"spark"}}},{"title":"Prediction by Carrier","text":"%sql\nselect carrier, prediction, count(prediction) from flights \ngroup by carrier, prediction order by carrier","user":"anonymous","dateUpdated":"2019-03-07T18:59:09+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"carrier":"string","prediction":"string","count(prediction)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[{"name":"prediction","index":1,"aggr":"sum"}],"values":[{"name":"count(prediction)","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tprediction\tcount(prediction)\nAA\t0.0\t67575\nAA\t1.0\t41852\nDL\t0.0\t38914\nDL\t1.0\t19281\nUA\t0.0\t59674\nUA\t1.0\t39304\nWN\t1.0\t7629\nWN\t0.0\t8399\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220189_-1675544628","id":"20171110-195759_439800395","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13520","dateFinished":"2019-03-07T18:58:13+0000","dateStarted":"2019-03-07T18:58:09+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=389"],"interpreterSettingId":"spark"}}},{"text":"%sql\nselect carrier, label, count(label) from flights \ngroup by carrier, label order by carrier","user":"anonymous","dateUpdated":"2019-03-07T19:00:03+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"carrier":"string","prediction":"string","count(prediction)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[{"name":"label","index":1,"aggr":"sum"}],"values":[{"name":"count(label)","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551985156112_283724828","id":"20190307-185916_989655140","dateCreated":"2019-03-07T18:59:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:26841","dateFinished":"2019-03-07T18:59:54+0000","dateStarted":"2019-03-07T18:59:51+0000","title":"Label by Carrier","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tlabel\tcount(label)\nAA\t0.0\t97600\nAA\t1.0\t11827\nDL\t0.0\t52730\nDL\t1.0\t5465\nUA\t0.0\t88465\nUA\t1.0\t10513\nWN\t1.0\t2164\nWN\t0.0\t13864\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=391"],"interpreterSettingId":"spark"}}},{"title":"Label  by Destination Airport","text":"%sql\nSELECT dst,label, count(label)  \nFROM flights \nGROUP BY dst, label\n","user":"anonymous","dateUpdated":"2019-03-07T19:01:17+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dst":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"dst","index":0,"aggr":"sum"}],"groups":[{"name":"label","index":1,"aggr":"sum"}],"values":[{"name":"count(label)","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dst\tlabel\tcount(label)\nDEN\t0.0\t20975\nCLT\t0.0\t15378\nBOS\t0.0\t16557\nLGA\t1.0\t2425\nLGA\t0.0\t18009\nMIA\t1.0\t1785\nCLT\t1.0\t1421\nDFW\t0.0\t22434\nIAH\t1.0\t1504\nSEA\t0.0\t11505\nEWR\t1.0\t2855\nEWR\t0.0\t15681\nMIA\t0.0\t16218\nIAH\t0.0\t16037\nLAX\t0.0\t24325\nORD\t1.0\t3535\nORD\t0.0\t28779\nSFO\t1.0\t2997\nDFW\t1.0\t2513\nATL\t1.0\t2809\nDEN\t1.0\t2227\nLAX\t1.0\t2544\nSEA\t1.0\t1221\nBOS\t1.0\t2133\nSFO\t0.0\t19353\nATL\t0.0\t27408\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220189_-1794921787","id":"20171122-204956_303346727","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13521","dateFinished":"2019-03-07T19:01:10+0000","dateStarted":"2019-03-07T19:01:07+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=397","http://6eb9f2b30c98:4040/jobs/job?id=398","http://6eb9f2b30c98:4040/jobs/job?id=399","http://6eb9f2b30c98:4040/jobs/job?id=400","http://6eb9f2b30c98:4040/jobs/job?id=401"],"interpreterSettingId":"spark"}}},{"text":"%sql\nSELECT dst,prediction, count(prediction)  \nFROM flights \nGROUP BY dst, prediction\n","user":"anonymous","dateUpdated":"2019-03-07T19:02:13+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dst":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"dst","index":0,"aggr":"sum"}],"groups":[{"name":"prediction","index":1,"aggr":"sum"}],"values":[{"name":"count(prediction)","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551985287644_-1616230956","id":"20190307-190127_23633985","dateCreated":"2019-03-07T19:01:27+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:28237","dateFinished":"2019-03-07T19:02:04+0000","dateStarted":"2019-03-07T19:02:01+0000","title":"Prediction by Destination Airport","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dst\tprediction\tcount(prediction)\nDEN\t0.0\t15086\nCLT\t0.0\t13538\nBOS\t0.0\t11267\nLGA\t1.0\t10105\nLGA\t0.0\t10329\nMIA\t1.0\t5585\nCLT\t1.0\t3261\nDFW\t0.0\t15682\nIAH\t1.0\t5002\nSEA\t0.0\t8775\nEWR\t1.0\t9590\nEWR\t0.0\t8946\nMIA\t0.0\t12418\nIAH\t0.0\t12539\nLAX\t0.0\t16503\nORD\t1.0\t14079\nORD\t0.0\t18235\nSFO\t1.0\t12215\nDFW\t1.0\t9265\nATL\t1.0\t9108\nDEN\t1.0\t8116\nLAX\t1.0\t10366\nSEA\t1.0\t3951\nBOS\t1.0\t7423\nSFO\t0.0\t10135\nATL\t0.0\t21109\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=402","http://6eb9f2b30c98:4040/jobs/job?id=403","http://6eb9f2b30c98:4040/jobs/job?id=404","http://6eb9f2b30c98:4040/jobs/job?id=405","http://6eb9f2b30c98:4040/jobs/job?id=406"],"interpreterSettingId":"spark"}}},{"title":"Label Departure Delay by Originating Airport","text":"%sql\nSELECT src, label, count(label)\nFROM flights \nGROUP BY src, label\n","user":"anonymous","dateUpdated":"2019-03-07T19:03:19+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"src":"string","label":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"src","index":0,"aggr":"sum"}],"groups":[{"name":"label","index":1,"aggr":"sum"}],"values":[{"name":"count(label)","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"src\tlabel\tcount(label)\nDEN\t0.0\t21052\nCLT\t0.0\t14912\nBOS\t0.0\t16840\nLGA\t1.0\t1984\nLGA\t0.0\t18498\nMIA\t1.0\t2340\nCLT\t1.0\t1796\nDFW\t0.0\t22114\nIAH\t1.0\t1862\nSEA\t0.0\t11833\nEWR\t1.0\t2372\nEWR\t0.0\t16279\nMIA\t0.0\t15649\nIAH\t0.0\t15812\nLAX\t0.0\t24694\nORD\t1.0\t4128\nORD\t0.0\t27944\nSFO\t1.0\t2308\nDFW\t1.0\t2858\nATL\t1.0\t3186\nDEN\t1.0\t2358\nLAX\t1.0\t2170\nSEA\t1.0\t864\nBOS\t1.0\t1743\nATL\t0.0\t26979\nSFO\t0.0\t20053\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220189_1045876821","id":"20171122-204822_1853914961","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13522","dateFinished":"2019-03-07T19:03:03+0000","dateStarted":"2019-03-07T19:03:00+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=407","http://6eb9f2b30c98:4040/jobs/job?id=408","http://6eb9f2b30c98:4040/jobs/job?id=409","http://6eb9f2b30c98:4040/jobs/job?id=410","http://6eb9f2b30c98:4040/jobs/job?id=411"],"interpreterSettingId":"spark"}}},{"text":"%sql\nSELECT src, prediction, count(prediction)\nFROM flights \nGROUP BY src, prediction\n","user":"anonymous","dateUpdated":"2019-03-07T19:04:18+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"src":"string","label":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"src","index":0,"aggr":"sum"}],"groups":[{"name":"prediction","index":1,"aggr":"sum"}],"values":[{"name":"count(prediction)","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551985414818_1557786896","id":"20190307-190334_411445587","dateCreated":"2019-03-07T19:03:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:29369","dateFinished":"2019-03-07T19:04:08+0000","dateStarted":"2019-03-07T19:04:05+0000","title":"Prediction Departure Delay by Originating Airport","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"src\tprediction\tcount(prediction)\nDEN\t0.0\t13668\nCLT\t0.0\t10381\nBOS\t0.0\t14141\nLGA\t1.0\t7546\nLGA\t0.0\t12936\nMIA\t1.0\t9119\nCLT\t1.0\t6327\nDFW\t0.0\t13541\nIAH\t1.0\t5036\nSEA\t0.0\t11369\nEWR\t1.0\t8223\nEWR\t0.0\t10428\nMIA\t0.0\t8870\nIAH\t0.0\t12638\nLAX\t0.0\t20980\nORD\t1.0\t18516\nORD\t0.0\t13556\nSFO\t1.0\t8289\nDFW\t1.0\t11431\nATL\t1.0\t12183\nDEN\t1.0\t9742\nLAX\t1.0\t5884\nSEA\t1.0\t1328\nBOS\t1.0\t4442\nATL\t0.0\t17982\nSFO\t0.0\t14072\n"},{"type":"TEXT","data":""}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=412","http://6eb9f2b30c98:4040/jobs/job?id=413","http://6eb9f2b30c98:4040/jobs/job?id=414","http://6eb9f2b30c98:4040/jobs/job?id=415","http://6eb9f2b30c98:4040/jobs/job?id=416"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Day of the Week (1=Monday, 7=Sunday)","text":"%sql\nselect dofW, label, count(label), prediction, count(prediction)\nfrom flights \ngroup by dofW, label, prediction\n","user":"anonymous","dateUpdated":"2019-03-07T19:05:17+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dofW":"string","label":"string","count(label)":"string","prediction":"string","count(prediction)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"dofW","index":0,"aggr":"sum"}],"groups":[{"name":"label","index":1,"aggr":"sum"}],"values":[{"name":"count(label)","index":2,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dofW\tlabel\tcount(label)\tprediction\tcount(prediction)\n1\t0.0\t22838\t0.0\t22838\n3\t1.0\t2395\t1.0\t2395\n3\t0.0\t12663\t1.0\t12663\n6\t0.0\t25114\t0.0\t25114\n5\t1.0\t1607\t0.0\t1607\n3\t0.0\t24127\t0.0\t24127\n1\t1.0\t1660\t0.0\t1660\n4\t1.0\t3440\t1.0\t3440\n3\t1.0\t1684\t0.0\t1684\n1\t0.0\t14831\t1.0\t14831\n5\t0.0\t13922\t1.0\t13922\n2\t1.0\t2963\t1.0\t2963\n2\t0.0\t24206\t0.0\t24206\n7\t1.0\t2796\t1.0\t2796\n7\t1.0\t1458\t0.0\t1458\n5\t0.0\t23772\t0.0\t23772\n6\t0.0\t5926\t1.0\t5926\n7\t0.0\t20786\t0.0\t20786\n6\t1.0\t1714\t0.0\t1714\n2\t0.0\t14136\t1.0\t14136\n4\t0.0\t14568\t1.0\t14568\n7\t0.0\t13186\t1.0\t13186\n1\t1.0\t3113\t1.0\t3113\n2\t1.0\t1534\t0.0\t1534\n4\t1.0\t1478\t0.0\t1478\n5\t1.0\t3186\t1.0\t3186\n6\t1.0\t941\t1.0\t941\n4\t0.0\t22584\t0.0\t22584\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220190_-1345382050","id":"20171123-101016_2040441762","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13523","dateFinished":"2019-03-07T19:04:28+0000","dateStarted":"2019-03-07T19:04:24+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=417","http://6eb9f2b30c98:4040/jobs/job?id=418","http://6eb9f2b30c98:4040/jobs/job?id=419","http://6eb9f2b30c98:4040/jobs/job?id=420","http://6eb9f2b30c98:4040/jobs/job?id=421"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Carrier (where label=1)","text":"%sql\nselect carrier, count(label)\nfrom flights where label = 1\ngroup by carrier\norder by carrier","user":"anonymous","dateUpdated":"2019-03-07T19:06:00+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"carrier":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tcount(label)\nAA\t11827\nDL\t5465\nUA\t10513\nWN\t2164\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220190_1239582105","id":"20171123-042011_1532799341","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13524","dateFinished":"2019-03-07T19:06:02+0000","dateStarted":"2019-03-07T19:06:00+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=422"],"interpreterSettingId":"spark"}}},{"title":"Count of Delayed Not Delayed  by Carrier","text":"%sql\nSELECT label, count(label),carrier\nFROM flights\nGROUP BY carrier, label\norder by carrier\n","user":"anonymous","dateUpdated":"2019-03-07T19:06:11+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","count(label)":"string","carrier":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"carrier","index":2,"aggr":"sum"}],"groups":[],"values":[]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"label\tcount(label)\tcarrier\n0.0\t97600\tAA\n1.0\t11827\tAA\n1.0\t5465\tDL\n0.0\t52730\tDL\n0.0\t88465\tUA\n1.0\t10513\tUA\n0.0\t13864\tWN\n1.0\t2164\tWN\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220191_276402350","id":"20170524-144751_554129160","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13525","dateFinished":"2019-03-07T19:06:14+0000","dateStarted":"2019-03-07T19:06:11+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=423"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Hour of Day","text":"%sql\nselect crsdephour, count(depdelay)\nfrom flights where depdelay > 40\ngroup by crsdephour\n","user":"anonymous","dateUpdated":"2019-03-07T19:06:25+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"crsdephour","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"crsdephour\tcount(depdelay)\n12\t1893\n22\t1066\n1\t51\n13\t1728\n16\t2309\n6\t518\n20\t2260\n5\t175\n19\t2198\n15\t1969\n9\t1112\n17\t2434\n8\t1067\n23\t364\n7\t1068\n10\t1472\n24\t58\n21\t1180\n11\t1321\n14\t2041\n0\t106\n18\t2929\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220191_-1143502248","id":"20171129-200107_756396508","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13526","dateFinished":"2019-03-07T19:06:24+0000","dateStarted":"2019-03-07T19:06:22+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=424","http://6eb9f2b30c98:4040/jobs/job?id=425","http://6eb9f2b30c98:4040/jobs/job?id=426","http://6eb9f2b30c98:4040/jobs/job?id=427","http://6eb9f2b30c98:4040/jobs/job?id=428"],"interpreterSettingId":"spark"}}},{"title":"Count of Delayed , Not Delayed by Hour","text":"%sql\nSELECT prediction, count(prediction),crsdephour\nFROM flights\nGROUP BY crsdephour, prediction\n","user":"anonymous","dateUpdated":"2019-03-07T19:06:28+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"prediction":"string","count(prediction)":"string","crsdephour":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"crsdephour","index":2,"aggr":"sum"}],"groups":[{"name":"delayed","index":0,"aggr":"sum"}],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\tcount(prediction)\tcrsdephour\n0.0\t14116\t11\n1.0\t1096\t9\n1.0\t4538\t12\n1.0\t11552\t19\n0.0\t1268\t1\n1.0\t11411\t20\n0.0\t23136\t7\n1.0\t2145\t11\n0.0\t1517\t19\n1.0\t714\t23\n1.0\t12656\t17\n1.0\t15286\t18\n1.0\t585\t8\n1.0\t8307\t14\n0.0\t2124\t21\n1.0\t5567\t21\n0.0\t2609\t18\n0.0\t2355\t23\n0.0\t1457\t0\n1.0\t6442\t13\n1.0\t24\t24\n0.0\t3240\t22\n0.0\t14145\t12\n0.0\t17483\t8\n0.0\t17317\t10\n0.0\t1524\t20\n0.0\t8857\t14\n1.0\t5068\t22\n0.0\t9181\t13\n1.0\t297\t7\n1.0\t11639\t16\n0.0\t1051\t24\n0.0\t17178\t6\n0.0\t14962\t9\n0.0\t18\t2\n0.0\t5331\t16\n1.0\t9109\t15\n1.0\t148\t0\n0.0\t6162\t15\n0.0\t6265\t5\n1.0\t1482\t10\n0.0\t3266\t17\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220191_-223750916","id":"20170524-095127_757444423","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13527","dateFinished":"2019-03-07T19:06:31+0000","dateStarted":"2019-03-07T19:06:28+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=429","http://6eb9f2b30c98:4040/jobs/job?id=430","http://6eb9f2b30c98:4040/jobs/job?id=431","http://6eb9f2b30c98:4040/jobs/job?id=432","http://6eb9f2b30c98:4040/jobs/job?id=433"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Origin, Destination","text":"%sql\nselect src, dst, count(label)\nfrom flights where label=1.0\ngroup by src, dst\nORDER BY count(label) desc\n","user":"anonymous","dateUpdated":"2019-03-07T19:07:32+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"src":"string","dst":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"src","index":0,"aggr":"sum"}],"groups":[{"name":"dst","index":1,"aggr":"sum"}],"values":[]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"src\tdst\tcount(label)\nORD\tLGA\t601\nLAX\tSFO\t589\nATL\tEWR\t576\nLGA\tORD\t541\nORD\tSFO\t478\nSFO\tLAX\t476\nATL\tLGA\t464\nORD\tLAX\t433\nORD\tDFW\t432\nDEN\tSFO\t395\nDFW\tORD\t392\nEWR\tATL\t386\nMIA\tLGA\t362\nORD\tEWR\t353\nSFO\tORD\t351\nLGA\tATL\t350\nORD\tATL\t337\nDFW\tATL\t337\nORD\tBOS\t329\nDEN\tLAX\t321\nLAX\tDEN\t310\nORD\tDEN\t310\nMIA\tATL\t304\nSFO\tDEN\t303\nLAX\tORD\t302\nEWR\tORD\t300\nATL\tDFW\t297\nBOS\tLGA\t285\nATL\tLAX\t280\nATL\tORD\t279\nDEN\tEWR\t279\nLGA\tBOS\t279\nIAH\tEWR\t276\nBOS\tEWR\t275\nDFW\tSFO\t272\nDEN\tORD\t272\nBOS\tORD\t271\nMIA\tORD\t267\nIAH\tDFW\t266\nDFW\tIAH\t265\nMIA\tDFW\t264\nEWR\tSFO\t262\nEWR\tBOS\t261\nCLT\tEWR\t261\nATL\tMIA\t259\nLGA\tMIA\t254\nATL\tBOS\t247\nORD\tSEA\t236\nDFW\tMIA\t227\nDFW\tDEN\t226\nORD\tMIA\t223\nORD\tIAH\t220\nDFW\tLAX\t220\nDFW\tLGA\t219\nSFO\tEWR\t219\nCLT\tORD\t214\nLAX\tATL\t209\nMIA\tEWR\t207\nEWR\tLAX\t207\nSFO\tDFW\t205\nMIA\tLAX\t204\nIAH\tSFO\t202\nDFW\tEWR\t201\nSFO\tSEA\t201\nDEN\tDFW\t201\nATL\tDEN\t199\nBOS\tATL\t198\nIAH\tORD\t195\nSEA\tSFO\t193\nEWR\tMIA\t190\nCLT\tATL\t189\nLGA\tDEN\t189\nATL\tSFO\t189\nDFW\tCLT\t188\nDEN\tLGA\t187\nCLT\tBOS\t186\nEWR\tDEN\t185\nMIA\tBOS\t183\nEWR\tIAH\t180\nDFW\tSEA\t178\nATL\tCLT\t177\nORD\tCLT\t176\nLAX\tDFW\t176\nMIA\tCLT\t174\nSFO\tBOS\t168\nEWR\tCLT\t167\nMIA\tSFO\t166\nLGA\tDFW\t165\nDEN\tATL\t164\nDEN\tSEA\t163\nEWR\tDFW\t161\nCLT\tDFW\t159\nIAH\tLGA\t154\nCLT\tLGA\t153\nSEA\tORD\t151\nCLT\tMIA\t145\nLAX\tEWR\t141\nIAH\tDEN\t141\nIAH\tLAX\t139\nIAH\tATL\t136\nDFW\tBOS\t133\nSEA\tDEN\t130\nSFO\tATL\t130\nLAX\tMIA\t129\nLGA\tCLT\t127\nATL\tIAH\t127\nMIA\tIAH\t126\nCLT\tSFO\t126\nBOS\tSFO\t125\nSFO\tIAH\t124\nDEN\tIAH\t122\nBOS\tCLT\t119\nDEN\tBOS\t118\nLAX\tBOS\t116\nBOS\tLAX\t115\nCLT\tDEN\t109\nCLT\tLAX\t100\nSEA\tDFW\t100\nBOS\tMIA\t99\nIAH\tMIA\t97\nATL\tSEA\t92\nIAH\tBOS\t92\nCLT\tIAH\t89\nBOS\tDFW\t87\nIAH\tCLT\t87\nBOS\tDEN\t83\nLGA\tIAH\t79\nIAH\tSEA\t77\nEWR\tSEA\t73\nLAX\tSEA\t72\nSFO\tMIA\t71\nDEN\tCLT\t70\nSEA\tATL\t69\nLAX\tCLT\t67\nSEA\tEWR\t67\nDEN\tMIA\t66\nCLT\tSEA\t65\nBOS\tIAH\t63\nSFO\tCLT\t60\nLAX\tIAH\t59\nSEA\tIAH\t50\nSEA\tLAX\t49\nMIA\tDEN\t42\nMIA\tSEA\t41\nSEA\tMIA\t25\nBOS\tSEA\t23\nSEA\tBOS\t21\nSEA\tCLT\t9\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551984220193_-896786407","id":"20171123-102627_1669385618","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13532","dateFinished":"2019-03-07T19:07:34+0000","dateStarted":"2019-03-07T19:07:32+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=434"],"interpreterSettingId":"spark"}}},{"title":"Calculate some more metrics","text":"val lp = df.select( \"label\", \"prediction\")\nval counttotal = lp.count().toDouble\nval correct = lp.filter($\"label\" === $\"prediction\").count().toDouble\nval wrong = lp.filter(not($\"label\" === $\"prediction\")).count().toDouble\nval truep =( lp.filter($\"label\" === 1.0).filter($\"label\" === $\"prediction\").count()) /counttotal\nval truen = (lp.filter($\"label\" === 0.0).filter($\"label\" === $\"prediction\").count())/counttotal\nval falsep = (lp.filter($\"label\" === 1.0).filter(not($\"label\" === $\"prediction\")).count())/counttotal\nval falsen = (lp.filter($\"label\" === 0.0).filter(not($\"label\" === $\"prediction\")).count())/counttotal\nval ratioWrong=wrong/counttotal\nval ratioCorrect=correct/counttotal\nval precision = truep / (truep + falsep)\n","user":"anonymous","dateUpdated":"2019-03-07T19:07:45+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lp: org.apache.spark.sql.DataFrame = [label: double, prediction: double]\ncounttotal: Double = 282628.0\ncorrect: Double = 182261.0\nwrong: Double = 100367.0\ntruep: Double = 0.06663883267050681\ntruen: Double = 0.5782406555613739\nfalsep: Double = 0.03939807803897703\nfalsen: Double = 0.3157224337291422\nratioWrong: Double = 0.3551205117681192\nratioCorrect: Double = 0.6448794882318808\nprecision: Double = 0.628449397710968\n"}]},"apps":[],"jobName":"paragraph_1551984220194_-480913117","id":"20181015-224231_2027590368","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13533","dateFinished":"2019-03-07T19:08:02+0000","dateStarted":"2019-03-07T19:07:45+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://6eb9f2b30c98:4040/jobs/job?id=435","http://6eb9f2b30c98:4040/jobs/job?id=436","http://6eb9f2b30c98:4040/jobs/job?id=437","http://6eb9f2b30c98:4040/jobs/job?id=438","http://6eb9f2b30c98:4040/jobs/job?id=439","http://6eb9f2b30c98:4040/jobs/job?id=440","http://6eb9f2b30c98:4040/jobs/job?id=441"],"interpreterSettingId":"spark"}}},{"text":"writedb.stop()","user":"anonymous","dateUpdated":"2019-03-07T19:08:12+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551984220194_-380731760","id":"20171122-091021_1615582434","dateCreated":"2019-03-07T18:43:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:13534","dateFinished":"2019-03-07T19:08:13+0000","dateStarted":"2019-03-07T19:08:12+0000"},{"user":"anonymous","dateUpdated":"2019-03-07T18:43:40+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551984220195_-18845303","id":"20190307-175040_1835736035","dateCreated":"2019-03-07T18:43:40+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:13535"}],"name":"FlightStructuredStreaming","id":"2E89C78SY","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}