{"paragraphs":[{"text":"%md \n## Streaming Data\nMapR Event Store is a distributed publish-subscribe event streaming system that enables producers and consumers to exchange events in real time in a parallel and fault-tolerant manner via the Apache Kafka API.\nA stream represents a continuous sequence of events that goes from producers to consumers, where an event is defined as a key-value pair.\n<img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image29.png\">\nThe Streaming event values have the following format:\n\n{\"id\":\"ATL_BOS_2018-01-01_DL_104\",\"fldate\":\"2018-01-01\",\"month\":1,\"dofW\":1,\n\"carrier\":\"DL\",\"src\":\"ATL\",\"dst\":\"BOS\",\"crsdephour\":9,\"crsdeptime\":850,\"depdelay\":0.0,\n\"crsarrtime\":1116,\"arrdelay\":0.0,\"crselapsedtime\":146.0,\"dist\":946.0}\n\nWe will use the machine learning model to enrich the events with the flight delay label and predictions and we will store the results in MapR Database. \n\n<img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image46.png\">","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Streaming Data</h2>\n<p>MapR Event Store is a distributed publish-subscribe event streaming system that enables producers and consumers to exchange events in real time in a parallel and fault-tolerant manner via the Apache Kafka API.<br/>A stream represents a continuous sequence of events that goes from producers to consumers, where an event is defined as a key-value pair.<br/><img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image29.png\"><br/>The Streaming event values have the following format:</p>\n<p>{&ldquo;id&rdquo;:&ldquo;ATL_BOS_2018-01-01_DL_104&rdquo;,&ldquo;fldate&rdquo;:&ldquo;2018-01-01&rdquo;,&ldquo;month&rdquo;:1,&ldquo;dofW&rdquo;:1,<br/>&ldquo;carrier&rdquo;:&ldquo;DL&rdquo;,&ldquo;src&rdquo;:&ldquo;ATL&rdquo;,&ldquo;dst&rdquo;:&ldquo;BOS&rdquo;,&ldquo;crsdephour&rdquo;:9,&ldquo;crsdeptime&rdquo;:850,&ldquo;depdelay&rdquo;:0.0,<br/>&ldquo;crsarrtime&rdquo;:1116,&ldquo;arrdelay&rdquo;:0.0,&ldquo;crselapsedtime&rdquo;:146.0,&ldquo;dist&rdquo;:946.0}</p>\n<p>We will use the machine learning model to enrich the events with the flight delay label and predictions and we will store the results in MapR Database. </p>\n<img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image46.png\">\n</div>"}]},"apps":[],"jobName":"paragraph_1551921357288_-1250770983","id":"20170530-122945_1594214131","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:15982"},{"text":"%md\n## Spark Structured Streaming\n\nStructured Streaming is a scalable and fault-tolerant stream processing engine built on the Spark SQL engine. Structured Streaming enables you to view data published to Kafka as an unbounded DataFrame and process this data with the same DataFrame, Dataset, and SQL APIs used for batch processing.\n<img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image25.png\">","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Spark Structured Streaming</h2>\n<p>Structured Streaming is a scalable and fault-tolerant stream processing engine built on the Spark SQL engine. Structured Streaming enables you to view data published to Kafka as an unbounded DataFrame and process this data with the same DataFrame, Dataset, and SQL APIs used for batch processing.<br/><img src=\"https://mapr.com/blog/real-time-analysis-popular-uber-locations-spark-structured-streaming-machine-learning-kafka-and-mapr-db/assets/image25.png\"></p>\n</div>"}]},"apps":[],"jobName":"paragraph_1551921357291_-789218853","id":"20190220-173254_1728425170","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15983"},{"title":"Import needed packages","text":"%spark\nimport org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql._\nimport org.apache.spark.streaming._\n\nimport org.apache.spark.ml._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.evaluation._\nimport org.apache.spark.ml.tuning._\n","user":"anonymous","dateUpdated":"2019-03-07T01:34:15+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.SparkSession\nimport org.apache.spark.sql.types._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql._\nimport org.apache.spark.streaming._\nimport org.apache.spark.ml._\nimport org.apache.spark.ml.feature._\nimport org.apache.spark.ml.classification._\nimport org.apache.spark.ml.evaluation._\nimport org.apache.spark.ml.tuning._\n"}]},"apps":[],"jobName":"paragraph_1551921357291_575581457","id":"20170508-144514_403247535","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:15984","dateFinished":"2019-03-07T01:34:15+0000","dateStarted":"2019-03-07T01:34:15+0000"},{"title":"Define Schema for JSON streaming data","text":"\nimport org.apache.spark.sql.types._\n\n// {“id”:“ATL_BOS_2018-01-01_DL_104”,“fldate”:“2018-01-01”,“month”:1,“dofW”:1,\n//“carrier”:“DL”,“src”:“ATL”,“dst”:“BOS”,“crsdephour”:9,“crsdeptime”:850,“depdelay”:0.0,\n//“crsarrtime”:1116,“arrdelay”:0.0,“crselapsedtime”:146.0,“dist”:946.0}\n\n  val schema = StructType(Array(\n    StructField(\"id\", StringType, true),\n    StructField(\"fldate\", StringType, true),\n    StructField(\"month\", IntegerType, true),\n    StructField(\"dofW\", IntegerType, true),\n    StructField(\"carrier\", StringType, true),\n    StructField(\"src\", StringType, true),\n    StructField(\"dst\", StringType, true),\n    StructField(\"crsdephour\", IntegerType, true),\n    StructField(\"crsdeptime\", IntegerType, true),\n    StructField(\"depdelay\", DoubleType, true),\n    StructField(\"crsarrtime\", IntegerType, true),\n    StructField(\"arrdelay\", DoubleType, true),\n    StructField(\"crselapsedtime\", DoubleType, true),\n    StructField(\"dist\", DoubleType, true)\n  ))\n   ","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.types._\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(id,StringType,true), StructField(fldate,StringType,true), StructField(month,IntegerType,true), StructField(dofW,IntegerType,true), StructField(carrier,StringType,true), StructField(src,StringType,true), StructField(dst,StringType,true), StructField(crsdephour,IntegerType,true), StructField(crsdeptime,IntegerType,true), StructField(depdelay,DoubleType,true), StructField(crsarrtime,IntegerType,true), StructField(arrdelay,DoubleType,true), StructField(crselapsedtime,DoubleType,true), StructField(dist,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1551921357291_-1416297687","id":"20170508-150032_326029627","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15985"},{"title":"Define Topic , Table , and Model Directory","text":"// MapR Event Store for Kafka Topic to read from \nvar topic: String = \"/user/mapr/stream:flights\"\n// MapR Database table to write to \nvar tableName: String = \"/user/mapr/flighttable\"\n// Directory to read the saved ML model from \nvar modeldirectory: String  =\"maprfs:///user/mapr/model/\"\n","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"topic: String = /user/mapr/stream:flights\ntableName: String = /user/mapr/flighttable\nmodeldirectory: String = maprfs:///user/mapr/model/\n"}]},"apps":[],"jobName":"paragraph_1551921357292_988702847","id":"20170508-150131_378637203","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15986"},{"title":"Read the saved Machine Learning Model","text":"import spark.implicits._\nval model = org.apache.spark.ml.PipelineModel.load(modeldirectory)","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nmodel: org.apache.spark.ml.PipelineModel = pipeline_e6a723cccec5\n"}]},"apps":[],"jobName":"paragraph_1551921357292_-947778656","id":"20171129-221736_959969733","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15987"},{"text":"%md\n## Reading Data from Kafka Topics\nIn order to read from Kafka, we must first specify the stream format, topic, and offset options.For more information on the configuration parameters","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Reading Data from Kafka Topics</h2>\n<p>In order to read from Kafka, we must first specify the stream format, topic, and offset options.For more information on the configuration parameters</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1551921357292_1165982249","id":"20190306-165333_491584061","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15988"},{"title":"Read Stream from Kafka topic ","text":"val df1 = spark.readStream.format(\"kafka\")\n      .option(\"kafka.bootstrap.servers\", \"maprdemo:9092\")\n      .option(\"subscribe\", topic)\n      .option(\"group.id\", \"testgroup\")\n      .option(\"startingOffsets\", \"earliest\")\n      .option(\"failOnDataLoss\", false)\n      .option(\"maxOffsetsPerTrigger\", 1000)\n      .load()","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df1: org.apache.spark.sql.DataFrame = [key: binary, value: binary ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551921357293_-1496593871","id":"20190306-002931_1225657206","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15989"},{"title":"Print DataFrame Schema","text":"// readStream.format \"kafka\" returns a DataFrame with the following schema:\ndf1.printSchema","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- key: binary (nullable = true)\n |-- value: binary (nullable = true)\n |-- topic: string (nullable = true)\n |-- partition: integer (nullable = true)\n |-- offset: long (nullable = true)\n |-- timestamp: timestamp (nullable = true)\n |-- timestampType: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1551921357293_1417057895","id":"20171129-223643_463511351","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15990"},{"text":"%md\nThe next step is to parse and transform the binary values column into a Dataset of Flight schema.\nIn the code below: \n* first we use a select expression with a String Cast of the df1 column value to convert the value from binary to string\n* then we use the from_json Spark SQL function in a select expression to retrieve the JSON string as the specified schema StructTyp\n","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>The next step is to parse and transform the binary values column into a Dataset of Flight schema.<br/>In the code below:<br/>* first we use a select expression with a String Cast of the df1 column value to convert the value from binary to string<br/>* then we use the from_json Spark SQL function in a select expression to retrieve the JSON string as the specified schema StructTyp</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1551921357294_1723784657","id":"20190306-165945_2131987408","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15991"},{"title":"Parse the Message Values into a Dataframe of Flight Schema","text":"// cast the df1 column value to string\n// use the from_json function to convert value JSON string to flight schema\nval df2 = df1.select($\"value\" cast \"string\" as \"json\").select(from_json($\"json\", schema) as \"data\").select(\"data.*\")","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df2: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 12 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551921357294_-1707309941","id":"20190306-003118_1790885997","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15992"},{"text":" // add column orig_dest, needed feature for ML model\n val df3 = df2.withColumn(\"orig_dest\", concat($\"src\", lit(\"_\"), $\"dst\"))","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"df3: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 13 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551921357294_2019164444","id":"20190306-010238_1100520892","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15993"},{"text":"%md\n## Enriching the flight Dataframe with label and predictions\nWe transform the DataFrame with the model pipeline, which will tranform the features according to the pipeline, estimate and then return the predictions in a column of a new DateFrame.","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Enriching the flight Dataframe with label and predictions</h2>\n<p>We transform the DataFrame with the model pipeline, which will tranform the features according to the pipeline, estimate and then return the predictions in a column of a new DateFrame.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1551921357294_-1481026779","id":"20190306-171339_1154203095","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15994"},{"text":"// transform the DataFrame with the model pipeline, which will tranform the features according to the pipeline, \n// estimate and then return the predictions in a column of a new DateFrame\nval predictions = model.transform(df3)","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"predictions: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 23 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551921357295_-1729340597","id":"20190306-010315_921932660","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15995"},{"text":"case class Flight(id: String,fldate: String,month:Integer, dofW: Integer, carrier: String, src: String,dst: String, crsdephour: Integer, crsdeptime: Integer, depdelay: Double, crsarrtime: Integer, arrdelay: Double, crselapsedtime: Double, \n    dist: Double, orig_dest: String, label: String, prediction: String)\n    \n// select the columns that we want to store\nval lp = predictions.select($\"id\",$\"fldate\", $\"month\", $\"dofW\", $\"carrier\", $\"src\", $\"dst\", $\"orig_dest\",\n      $\"crsdephour\", $\"crsdeptime\", $\"crsarrtime\", $\"crselapsedtime\", $\"depdelay\",$\"arrdelay\",$\"dist\",\n      $\"label\", $\"prediction\").as[Flight]","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lp: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 15 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551921357295_1144739381","id":"20190306-010344_1169277532","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:15996"},{"text":"\nval schema2 = StructType(Array(\n    StructField(\"id\", StringType, true),\n    StructField(\"fldate\", StringType, true),\n    StructField(\"month\", IntegerType, true),\n    StructField(\"dofW\", IntegerType, true),\n    StructField(\"carrier\", StringType, true),\n    StructField(\"src\", StringType, true),\n    StructField(\"dst\", StringType, true),\n    StructField(\"crsdephour\", IntegerType, true),\n    StructField(\"crsdeptime\", IntegerType, true),\n    StructField(\"depdelay\", DoubleType, true),\n    StructField(\"crsarrtime\", IntegerType, true),\n    StructField(\"arrdelay\", DoubleType, true),\n    StructField(\"crselapsedtime\", DoubleType, true),\n    StructField(\"dist\", DoubleType, true),\n    StructField(\"orig_dest\", StringType, true),\n    StructField(\"label\", DoubleType, true),\n    StructField(\"prediction\", DoubleType, true)\n  ))","user":"anonymous","dateUpdated":"2019-03-07T01:37:14+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"schema2: org.apache.spark.sql.types.StructType = StructType(StructField(id,StringType,true), StructField(fldate,StringType,true), StructField(month,IntegerType,true), StructField(dofW,IntegerType,true), StructField(carrier,StringType,true), StructField(src,StringType,true), StructField(dst,StringType,true), StructField(crsdephour,IntegerType,true), StructField(crsdeptime,IntegerType,true), StructField(depdelay,DoubleType,true), StructField(crsarrtime,IntegerType,true), StructField(arrdelay,DoubleType,true), StructField(crselapsedtime,DoubleType,true), StructField(dist,DoubleType,true), StructField(orig_dest,StringType,true), StructField(label,DoubleType,true), StructField(prediction,DoubleType,true))\n"}]},"apps":[],"jobName":"paragraph_1551921357297_-1698473070","id":"20190306-211342_1150192494","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16000","dateFinished":"2019-03-07T01:37:15+0000","dateStarted":"2019-03-07T01:37:14+0000"},{"text":"import com.mapr.db.spark.impl._\nimport com.mapr.db.spark.streaming._\nimport com.mapr.db.spark.sql._\nimport com.mapr.db.spark.streaming.MapRDBSourceConfig\nval writedb = df2.writeStream\n      .format(MapRDBSourceConfig.Format)\n      .option(MapRDBSourceConfig.TablePathOption, tableName)\n      .option(MapRDBSourceConfig.IdFieldPathOption, \"id\")\n      .option(MapRDBSourceConfig.CreateTableOption, false)\n      .option(\"checkpointLocation\", \"/tmp/flight\")\n      .option(MapRDBSourceConfig.BulkModeOption, true)\n      .option(MapRDBSourceConfig.SampleSizeOption, 1000)\n      .start()\n\n","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.mapr.db.spark.impl._\nimport com.mapr.db.spark.streaming._\nimport com.mapr.db.spark.sql._\nimport com.mapr.db.spark.streaming.MapRDBSourceConfig\nwritedb: org.apache.spark.sql.streaming.StreamingQuery = org.apache.spark.sql.execution.streaming.StreamingQueryWrapper@4650b8cc\n"}]},"apps":[],"jobName":"paragraph_1551921357297_-816606381","id":"20190306-003127_1670791655","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16001"},{"text":"import org.apache.spark._\n\nimport com.mapr.db._\nimport com.mapr.db.spark._\nimport com.mapr.db.spark.impl._\nimport com.mapr.db.spark.sql._\n\nval spark = org.apache.spark.sql.SparkSession.builder().appName(\"flightread\").getOrCreate()\n","user":"anonymous","dateUpdated":"2019-03-07T01:35:35+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark._\nimport com.mapr.db._\nimport com.mapr.db.spark._\nimport com.mapr.db.spark.impl._\nimport com.mapr.db.spark.sql._\nspark: org.apache.spark.sql.SparkSession = org.apache.spark.sql.SparkSession@7a0689a2\n"}]},"apps":[],"jobName":"paragraph_1551921357298_458753765","id":"20190306-011141_1523714467","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16003","dateFinished":"2019-03-07T01:35:36+0000","dateStarted":"2019-03-07T01:35:35+0000"},{"text":" // load payment dataset from MapR-DB \nval df = spark.sparkSession.loadFromMapRDB(tableName, schema2)\n\ndf.show\n\ndf.createOrReplaceTempView(\"flights\")","user":"anonymous","dateUpdated":"2019-03-07T01:37:22+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+-----+---------+-----+----------+\n|                  id|    fldate|month|dofW|carrier|src|dst|crsdephour|crsdeptime|depdelay|crsarrtime|arrdelay|crselapsedtime| dist|orig_dest|label|prediction|\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+-----+---------+-----+----------+\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|         9|       850|     0.0|      1116|     0.0|         146.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        11|      1122|     8.0|      1349|     0.0|         147.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        14|      1356|     9.0|      1623|     0.0|         147.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        16|      1620|     0.0|      1851|     3.0|         151.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        19|      1940|     6.0|      2210|     0.0|         150.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        12|      1248|     0.0|      1513|     0.0|         145.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        22|      2215|     0.0|        39|     0.0|         144.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     DL|ATL|BOS|        15|      1500|    21.0|      1734|    33.0|         154.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     WN|ATL|BOS|        15|      1500|   198.0|      1725|   208.0|         145.0|946.0|  ATL_BOS|  1.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     WN|ATL|BOS|        21|      2055|    14.0|      2330|     0.0|         155.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-01|    1|   1|     WN|ATL|BOS|        10|      1015|   215.0|      1250|   191.0|         155.0|946.0|  ATL_BOS|  1.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|         9|       850|     9.0|      1116|     0.0|         146.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        11|      1123|     0.0|      1350|     0.0|         147.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        10|      1000|    22.0|      1232|    10.0|         152.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        14|      1356|     6.0|      1623|    21.0|         147.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        22|      2227|     8.0|        51|     0.0|         144.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        16|      1620|     0.0|      1851|     0.0|         151.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        19|      1940|    62.0|      2210|    50.0|         150.0|946.0|  ATL_BOS|  1.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        12|      1248|    15.0|      1513|     7.0|         145.0|946.0|  ATL_BOS|  0.0|       0.0|\n|ATL_BOS_2018-01-0...|2018-01-02|    1|   2|     DL|ATL|BOS|        21|      2107|    12.0|      2335|    29.0|         148.0|946.0|  ATL_BOS|  0.0|       0.0|\n+--------------------+----------+-----+----+-------+---+---+----------+----------+--------+----------+--------+--------------+-----+---------+-----+----------+\nonly showing top 20 rows\n\ndf: org.apache.spark.sql.DataFrame = [id: string, fldate: string ... 15 more fields]\n"}]},"apps":[],"jobName":"paragraph_1551921357298_-1001609331","id":"20190306-011320_1619042382","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16004","dateFinished":"2019-03-07T01:37:26+0000","dateStarted":"2019-03-07T01:37:22+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=50"],"interpreterSettingId":"spark"}}},{"text":"%md \n# Use Spark SQL to explore the dataset","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Use Spark SQL to explore the dataset</h1>\n</div>"}]},"apps":[],"jobName":"paragraph_1551921357298_125980943","id":"20170603-182655_1680505289","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16005"},{"text":"df.count","user":"anonymous","dateUpdated":"2019-03-07T01:37:50+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551921357299_-1074711168","id":"20190306-003457_1891238408","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16006","dateFinished":"2019-03-07T01:37:51+0000","dateStarted":"2019-03-07T01:37:50+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"res14: Long = 92000\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=51"],"interpreterSettingId":"spark"}}},{"user":"anonymous","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551922711877_402735155","id":"20190307-013831_777164675","dateCreated":"2019-03-07T01:38:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:22414","text":"df.groupBy(\"src\",\"dst\",\"label\",\"prediction\").count.show","dateUpdated":"2019-03-07T01:38:35+0000","dateFinished":"2019-03-07T01:38:37+0000","dateStarted":"2019-03-07T01:38:35+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---+---+-----+----------+-----+\n|src|dst|label|prediction|count|\n+---+---+-----+----------+-----+\n|CLT|DFW|  0.0|       0.0|  648|\n|LAX|BOS|  1.0|       0.0|   23|\n|DEN|CLT|  0.0|       0.0|  293|\n|SFO|CLT|  1.0|       0.0|   11|\n|LGA|DFW|  0.0|       0.0|  615|\n|DEN|EWR|  1.0|       0.0|   71|\n|ATL|CLT|  0.0|       0.0|  873|\n|EWR|DFW|  0.0|       0.0|  323|\n|IAH|SEA|  0.0|       0.0|  241|\n|SEA|SFO|  1.0|       0.0|   35|\n|EWR|BOS|  1.0|       0.0|   48|\n|IAH|SEA|  1.0|       0.0|   18|\n|LGA|CLT|  1.0|       0.0|   43|\n|SFO|ORD|  0.0|       0.0|  809|\n|SFO|CLT|  0.0|       0.0|  302|\n|DFW|MIA|  0.0|       0.0|  589|\n|CLT|SEA|  1.0|       0.0|   14|\n|ORD|BOS|  0.0|       0.0|  757|\n|IAH|LGA|  0.0|       0.0|  401|\n|LAX|EWR|  0.0|       0.0|  585|\n+---+---+-----+----------+-----+\nonly showing top 20 rows\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=52","http://a4a0c1839040:4040/jobs/job?id=53","http://a4a0c1839040:4040/jobs/job?id=54"],"interpreterSettingId":"spark"}}},{"title":"Top 5 Longest departure delays","text":"%sql \nselect carrier,src, dst, depdelay,crsdephour, dist, dofW\nfrom flights \norder by depdelay desc limit 5 \n","user":"anonymous","dateUpdated":"2019-03-07T01:39:05+0000","config":{"tableHide":false,"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","editorHide":false,"fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"carrier":"string","src":"string","dst":"string","depdelay":"string","crsdephour":"string","dist":"string","dofW":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tsrc\tdst\tdepdelay\tcrsdephour\tdist\tdofW\nUA\tBOS\tORD\t1334.0\t9\t867.0\t4\nDL\tATL\tBOS\t1086.0\t12\t946.0\t5\nUA\tEWR\tIAH\t1024.0\t20\t1400.0\t6\nAA\tORD\tMIA\t1013.0\t18\t1197.0\t5\nDL\tLAX\tATL\t942.0\t14\t1947.0\t5\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357299_-1586403332","id":"20171110-195321_1924356975","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16007","dateFinished":"2019-03-07T01:39:06+0000","dateStarted":"2019-03-07T01:39:05+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=55"],"interpreterSettingId":"spark"}}},{"title":"Average Departure Delay by Carrier","text":"%sql\nselect carrier, prediction, count(prediction) from flights \ngroup by carrier, prediction order by carrier","user":"anonymous","dateUpdated":"2019-03-07T01:39:54+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"carrier":"string","prediction":"string","count(prediction)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avg(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tprediction\tcount(prediction)\nAA\t1.0\t3\nAA\t0.0\t37609\nDL\t0.0\t17224\nUA\t0.0\t31704\nWN\t0.0\t5460\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357299_-522209677","id":"20171110-195759_439800395","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16008","dateFinished":"2019-03-07T01:39:53+0000","dateStarted":"2019-03-07T01:39:52+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=56"],"interpreterSettingId":"spark"}}},{"title":"Average Departure Delay by Destination Airport","text":"%sql\nSELECT dst, count(label)  \nFROM flights \nGROUP BY dst\n","user":"anonymous","dateUpdated":"2019-03-07T01:40:34+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dst":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"dst","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avgdelay","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dst\tcount(label)\nIAH\t5762\nLGA\t6876\nBOS\t5818\nEWR\t6092\nDEN\t7305\nSEA\t3660\nCLT\t5851\nMIA\t6375\nDFW\t8355\nSFO\t6885\nATL\t9911\nORD\t10466\nLAX\t8644\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357300_-161324098","id":"20171122-204956_303346727","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16009","dateFinished":"2019-03-07T01:40:34+0000","dateStarted":"2019-03-07T01:40:32+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=57","http://a4a0c1839040:4040/jobs/job?id=58","http://a4a0c1839040:4040/jobs/job?id=59","http://a4a0c1839040:4040/jobs/job?id=60","http://a4a0c1839040:4040/jobs/job?id=61"],"interpreterSettingId":"spark"}}},{"title":"Average Departure Delay by Originating Airport","text":"%sql\nSELECT src, label, count(label)\nFROM flights \nGROUP BY src, label\n","user":"anonymous","dateUpdated":"2019-03-07T01:41:39+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"src":"string","label":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"src","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"avgdelay","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"src\tlabel\tcount(label)\nDEN\t0.0\t6841\nCLT\t0.0\t5401\nBOS\t0.0\t5381\nLGA\t1.0\t602\nLGA\t0.0\t6201\nMIA\t1.0\t453\nCLT\t1.0\t423\nDFW\t0.0\t7711\nIAH\t1.0\t534\nSEA\t0.0\t3419\nEWR\t1.0\t557\nEWR\t0.0\t5618\nMIA\t0.0\t5846\nIAH\t0.0\t5398\nLAX\t0.0\t8121\nORD\t1.0\t907\nORD\t0.0\t9288\nSFO\t1.0\t486\nDFW\t1.0\t740\nATL\t1.0\t837\nDEN\t1.0\t575\nLAX\t1.0\t507\nSEA\t1.0\t213\nBOS\t1.0\t456\nATL\t0.0\t9127\nSFO\t0.0\t6358\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357300_806608437","id":"20171122-204822_1853914961","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16010","dateFinished":"2019-03-07T01:41:39+0000","dateStarted":"2019-03-07T01:41:37+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=62","http://a4a0c1839040:4040/jobs/job?id=63","http://a4a0c1839040:4040/jobs/job?id=64","http://a4a0c1839040:4040/jobs/job?id=65","http://a4a0c1839040:4040/jobs/job?id=66"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Day of the Week (1=Monday, 7=Sunday)","text":"%sql\nselect dofW, label, count(label), prediction, count(prediction)\nfrom flights \ngroup by dofW, label, prediction\n","user":"anonymous","dateUpdated":"2019-03-07T01:42:44+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dofW":"string","label":"string","count(label)":"string","prediction":"string","count(prediction)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"dofW","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dofW\tlabel\tcount(label)\tprediction\tcount(prediction)\n1\t0.0\t13937\t0.0\t13937\n6\t0.0\t9759\t0.0\t9759\n5\t1.0\t1327\t0.0\t1327\n3\t0.0\t12072\t0.0\t12072\n1\t1.0\t1236\t0.0\t1236\n3\t1.0\t1093\t0.0\t1093\n2\t1.0\t2\t1.0\t2\n2\t0.0\t13183\t0.0\t13183\n7\t1.0\t1170\t0.0\t1170\n5\t0.0\t12075\t0.0\t12075\n6\t1.0\t604\t0.0\t604\n7\t0.0\t11405\t0.0\t11405\n2\t0.0\t1\t1.0\t1\n2\t1.0\t926\t0.0\t926\n4\t1.0\t932\t0.0\t932\n4\t0.0\t12278\t0.0\t12278\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357301_1663989185","id":"20171123-101016_2040441762","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16011","dateFinished":"2019-03-07T01:42:44+0000","dateStarted":"2019-03-07T01:42:42+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=67","http://a4a0c1839040:4040/jobs/job?id=68","http://a4a0c1839040:4040/jobs/job?id=69","http://a4a0c1839040:4040/jobs/job?id=70","http://a4a0c1839040:4040/jobs/job?id=71"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Carrier (where delay=40 minutes)","text":"%sql\nselect carrier, count(label)\nfrom flights where label = 1\ngroup by carrier\norder by carrier","user":"anonymous","dateUpdated":"2019-03-07T01:44:03+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"carrier":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"carrier","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"carrier\tcount(label)\nAA\t2834\nDL\t1469\nUA\t2416\nWN\t571\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357301_-1694661578","id":"20171123-042011_1532799341","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16012","dateFinished":"2019-03-07T01:44:03+0000","dateStarted":"2019-03-07T01:44:01+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=72"],"interpreterSettingId":"spark"}}},{"title":"Count of Delayed Not Delayed  by Carrier","text":"%sql\nSELECT label, count(label),carrier\nFROM flights\nGROUP BY carrier, label\norder by carrier\n","user":"anonymous","dateUpdated":"2019-03-07T01:50:11+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","count(label)":"string","carrier":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"carrier","index":2,"aggr":"sum"}],"groups":[],"values":[]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"label\tcount(label)\tcarrier\n1.0\t2834\tAA\n0.0\t34778\tAA\n0.0\t15755\tDL\n1.0\t1469\tDL\n0.0\t29288\tUA\n1.0\t2416\tUA\n1.0\t571\tWN\n0.0\t4889\tWN\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357301_568777944","id":"20170524-144751_554129160","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16013","dateFinished":"2019-03-07T01:50:07+0000","dateStarted":"2019-03-07T01:50:06+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=97"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Hour of Day","text":"%sql\nselect crsdephour, count(depdelay)\nfrom flights where depdelay > 40\ngroup by crsdephour\n","user":"anonymous","dateUpdated":"2019-03-07T01:49:42+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"}},"commonSetting":{},"keys":[{"name":"crsdephour","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"crsdephour\tcount(depdelay)\n12\t518\n22\t202\n1\t11\n13\t493\n16\t552\n6\t161\n20\t474\n5\t43\n19\t422\n15\t471\n9\t285\n17\t565\n8\t315\n23\t39\n7\t324\n10\t451\n24\t4\n21\t184\n11\t377\n14\t511\n0\t24\n18\t674\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357302_1919637183","id":"20171129-200107_756396508","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16014","dateFinished":"2019-03-07T01:49:42+0000","dateStarted":"2019-03-07T01:49:41+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=92","http://a4a0c1839040:4040/jobs/job?id=93","http://a4a0c1839040:4040/jobs/job?id=94","http://a4a0c1839040:4040/jobs/job?id=95","http://a4a0c1839040:4040/jobs/job?id=96"],"interpreterSettingId":"spark"}}},{"title":"Count of Delayed , Not Delayed by Hour","text":"%sql\nSELECT prediction, count(prediction),crsdephour\nFROM flights\nGROUP BY crsdephour, prediction\n","user":"anonymous","dateUpdated":"2019-03-07T01:49:02+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"prediction":"string","count(prediction)":"string","crsdephour":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"crsdephour","index":2,"aggr":"sum"}],"groups":[{"name":"delayed","index":0,"aggr":"sum"}],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\tcount(prediction)\tcrsdephour\n0.0\t5094\t11\n0.0\t358\t1\n0.0\t7754\t7\n0.0\t3942\t19\n0.0\t2102\t21\n0.0\t6039\t18\n0.0\t762\t23\n0.0\t589\t0\n0.0\t2815\t22\n0.0\t6443\t12\n0.0\t5890\t8\n0.0\t6575\t10\n0.0\t4177\t20\n0.0\t5498\t14\n0.0\t5189\t13\n0.0\t293\t24\n0.0\t5878\t6\n0.0\t4819\t9\n0.0\t6072\t16\n1.0\t3\t0\n0.0\t4747\t15\n0.0\t1740\t5\n0.0\t5221\t17\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357302_2050224306","id":"20170524-095127_757444423","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16015","dateFinished":"2019-03-07T01:49:02+0000","dateStarted":"2019-03-07T01:49:00+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=86","http://a4a0c1839040:4040/jobs/job?id=87","http://a4a0c1839040:4040/jobs/job?id=88","http://a4a0c1839040:4040/jobs/job?id=89","http://a4a0c1839040:4040/jobs/job?id=90"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Origin","text":"%sql\nselect src, count(depdelay)\nfrom flights where depdelay > 40\ngroup by src\nORDER BY src","user":"anonymous","dateUpdated":"2019-03-07T01:49:32+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"src":"string","count(depdelay)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[],"groups":[],"values":[{"name":"count(depdelay)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"src\tcount(depdelay)\nATL\t816\nBOS\t447\nCLT\t415\nDEN\t563\nDFW\t716\nEWR\t540\nIAH\t523\nLAX\t490\nLGA\t591\nMIA\t442\nORD\t880\nSEA\t205\nSFO\t472\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357302_-307704751","id":"20171123-101839_1671246939","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16016","dateFinished":"2019-03-07T01:49:28+0000","dateStarted":"2019-03-07T01:49:27+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=91"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Origin","text":"%sql\nSELECT label, count(label),src\nFROM flights\nGROUP BY src, label\norder by  src\n","user":"anonymous","dateUpdated":"2019-03-07T01:48:21+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"pieChart":{},"multiBarChart":{"stacked":false,"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"label":"string","count(label)":"string","src":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"src","index":2,"aggr":"sum"}],"groups":[{"name":"delayed","index":0,"aggr":"sum"}],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"label\tcount(label)\tsrc\n1.0\t837\tATL\n0.0\t9127\tATL\n0.0\t5381\tBOS\n1.0\t456\tBOS\n0.0\t5401\tCLT\n1.0\t423\tCLT\n1.0\t575\tDEN\n0.0\t6841\tDEN\n0.0\t7711\tDFW\n1.0\t740\tDFW\n0.0\t5618\tEWR\n1.0\t557\tEWR\n0.0\t5398\tIAH\n1.0\t534\tIAH\n0.0\t8121\tLAX\n1.0\t507\tLAX\n0.0\t6201\tLGA\n1.0\t602\tLGA\n1.0\t453\tMIA\n0.0\t5846\tMIA\n0.0\t9288\tORD\n1.0\t907\tORD\n0.0\t3419\tSEA\n1.0\t213\tSEA\n1.0\t486\tSFO\n0.0\t6358\tSFO\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357355_-448465912","id":"20171110-211045_792848918","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16017","dateFinished":"2019-03-07T01:48:21+0000","dateStarted":"2019-03-07T01:48:19+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=85"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Destination","text":"%sql\nselect dst, count(label)\nfrom flights where label = 1\ngroup by dst\nORDER BY dst\n","user":"anonymous","dateUpdated":"2019-03-07T01:48:01+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"dst":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"dst","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"count(delayed)","index":1,"aggr":"sum"}]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"dst\tcount(label)\nATL\t765\nBOS\t489\nCLT\t370\nDEN\t608\nDFW\t578\nEWR\t670\nIAH\t366\nLAX\t622\nLGA\t673\nMIA\t453\nORD\t799\nSEA\t259\nSFO\t638\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357356_-824635727","id":"20171123-102221_687729087","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16018","dateFinished":"2019-03-07T01:48:00+0000","dateStarted":"2019-03-07T01:47:59+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=84"],"interpreterSettingId":"spark"}}},{"title":"Count of Delayed not Delayed by Destination","text":"%sql\nSELECT prediction, count(prediction),dst\nFROM flights\nGROUP BY dst, prediction\norder by dst","user":"anonymous","dateUpdated":"2019-03-07T01:47:42+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"prediction":"string","count(prediction)":"string","dst":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"dst","index":2,"aggr":"sum"}],"groups":[],"values":[]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"prediction\tcount(prediction)\tdst\n0.0\t9911\tATL\n0.0\t5817\tBOS\n1.0\t1\tBOS\n0.0\t5851\tCLT\n1.0\t1\tDEN\n0.0\t7304\tDEN\n0.0\t8355\tDFW\n0.0\t6092\tEWR\n0.0\t5762\tIAH\n0.0\t8644\tLAX\n0.0\t6876\tLGA\n1.0\t1\tMIA\n0.0\t6374\tMIA\n0.0\t10466\tORD\n0.0\t3660\tSEA\n0.0\t6885\tSFO\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357356_1995603294","id":"20171122-211508_2036968500","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16019","dateFinished":"2019-03-07T01:47:39+0000","dateStarted":"2019-03-07T01:47:37+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=83"],"interpreterSettingId":"spark"}}},{"title":"Count of Departure Delays by Origin, Destination","text":"%sql\nselect src, dst, count(label)\nfrom flights where label=1.0\ngroup by src, dst\nORDER BY count(label) desc\n","user":"anonymous","dateUpdated":"2019-03-07T01:47:10+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"multiBarChart":{"rotate":{"degree":"-45"},"xLabelStatus":"default"},"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"src":"string","dst":"string","count(label)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{},"keys":[{"name":"src","index":0,"aggr":"sum"}],"groups":[{"name":"dst","index":1,"aggr":"sum"}],"values":[]},"helium":{}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"src\tdst\tcount(label)\nATL\tEWR\t136\nATL\tLGA\t133\nORD\tLGA\t132\nLAX\tSFO\t128\nLGA\tATL\t126\nLGA\tBOS\t126\nBOS\tLGA\t124\nDFW\tORD\t110\nLGA\tORD\t109\nSFO\tLAX\t104\nORD\tSFO\t99\nORD\tDFW\t96\nDFW\tATL\t95\nDEN\tLAX\t88\nEWR\tATL\t87\nORD\tLAX\t87\nSFO\tDEN\t84\nORD\tATL\t84\nIAH\tEWR\t84\nIAH\tDFW\t82\nMIA\tLGA\t82\nORD\tDEN\t80\nLAX\tDEN\t80\nDEN\tSFO\t79\nMIA\tATL\t79\nATL\tLAX\t79\nDFW\tIAH\t78\nATL\tMIA\t75\nATL\tDFW\t75\nLGA\tMIA\t74\nATL\tORD\t73\nEWR\tORD\t71\nDEN\tEWR\t71\nBOS\tEWR\t70\nDFW\tSFO\t69\nORD\tMIA\t68\nSFO\tORD\t68\nDEN\tLGA\t67\nORD\tBOS\t67\nDEN\tORD\t66\nLAX\tATL\t65\nATL\tDEN\t64\nDFW\tCLT\t61\nCLT\tORD\t60\nCLT\tEWR\t60\nEWR\tLAX\t60\nIAH\tSFO\t59\nEWR\tIAH\t59\nORD\tEWR\t59\nLGA\tDEN\t59\nDFW\tMIA\t58\nATL\tCLT\t58\nSFO\tEWR\t58\nDFW\tDEN\t56\nEWR\tSFO\t56\nIAH\tORD\t55\nLAX\tORD\t55\nDEN\tATL\t54\nDFW\tLAX\t54\nSEA\tDEN\t53\nBOS\tATL\t53\nEWR\tMIA\t52\nBOS\tORD\t51\nIAH\tLGA\t51\nDFW\tLGA\t50\nMIA\tORD\t50\nSFO\tDFW\t49\nORD\tIAH\t49\nEWR\tBOS\t48\nATL\tBOS\t46\nIAH\tDEN\t46\nCLT\tATL\t45\nDEN\tDFW\t44\nMIA\tEWR\t44\nMIA\tDFW\t44\nLGA\tCLT\t43\nORD\tCLT\t43\nORD\tSEA\t43\nCLT\tBOS\t42\nIAH\tATL\t41\nLGA\tDFW\t40\nDFW\tEWR\t40\nCLT\tDFW\t39\nDFW\tSEA\t39\nATL\tSFO\t38\nEWR\tCLT\t38\nEWR\tDFW\t37\nEWR\tDEN\t37\nATL\tIAH\t36\nCLT\tLAX\t36\nMIA\tBOS\t36\nIAH\tLAX\t35\nSEA\tSFO\t35\nCLT\tLGA\t34\nMIA\tLAX\t34\nLAX\tEWR\t33\nDEN\tSEA\t33\nLAX\tMIA\t32\nLAX\tSEA\t32\nLAX\tDFW\t32\nSEA\tORD\t31\nMIA\tCLT\t31\nIAH\tCLT\t30\nDFW\tBOS\t30\nSFO\tBOS\t29\nDEN\tIAH\t29\nSFO\tSEA\t28\nBOS\tLAX\t28\nBOS\tMIA\t27\nCLT\tSFO\t27\nBOS\tSFO\t26\nCLT\tDEN\t25\nLGA\tIAH\t25\nBOS\tCLT\t25\nSFO\tIAH\t24\nATL\tSEA\t24\nSEA\tDFW\t23\nLAX\tBOS\t23\nCLT\tMIA\t22\nMIA\tSFO\t22\nSFO\tATL\t22\nDEN\tBOS\t20\nCLT\tIAH\t19\nIAH\tSEA\t18\nBOS\tDEN\t18\nIAH\tMIA\t18\nMIA\tIAH\t17\nBOS\tDFW\t17\nSEA\tLAX\t17\nIAH\tBOS\t15\nSEA\tEWR\t15\nCLT\tSEA\t14\nLAX\tCLT\t14\nSEA\tATL\t14\nDEN\tCLT\t13\nLAX\tIAH\t13\nEWR\tSEA\t12\nDEN\tMIA\t11\nSFO\tCLT\t11\nBOS\tIAH\t9\nSFO\tMIA\t9\nBOS\tSEA\t8\nMIA\tSEA\t8\nSEA\tIAH\t8\nSEA\tMIA\t7\nSEA\tBOS\t7\nMIA\tDEN\t6\nSEA\tCLT\t3\n"},{"type":"TEXT","data":""}]},"apps":[],"jobName":"paragraph_1551921357356_-737918473","id":"20171123-102627_1669385618","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16020","dateFinished":"2019-03-07T01:46:53+0000","dateStarted":"2019-03-07T01:46:52+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=82"],"interpreterSettingId":"spark"}}},{"title":"Calculate some more metrics","text":"val lp = df.select( \"label\", \"prediction\")\nval counttotal = lp.count()\nval correct = lp.filter($\"label\" === $\"prediction\").count()\nval wrong = lp.filter(not($\"label\" === $\"prediction\")).count()\nval truep =( lp.filter($\"prediction\" === 0.0).filter($\"label\" === $\"prediction\").count()) /counttotal.toDouble\nval truen = (lp.filter($\"prediction\" === 1.0).filter($\"label\" === $\"prediction\").count())/counttotal.toDouble\nval falsen = (lp.filter($\"prediction\" === 0.0).filter(not($\"label\" === $\"prediction\")).count())/counttotal.toDouble\nval falsep = (lp.filter($\"prediction\" === 1.0).filter(not($\"label\" === $\"prediction\")).count())/counttotal.toDouble\nval ratioWrong=wrong.toDouble/counttotal.toDouble\nval ratioCorrect=correct.toDouble/counttotal.toDouble\n\nval precision = truep / (truep + falsep)\nval recall = truep / (truep + falsen)\nval fmeasure = 2 * precision * recall / (precision + recall)","user":"anonymous","dateUpdated":"2019-03-07T01:44:44+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"lp: org.apache.spark.sql.DataFrame = [label: double, prediction: double]\ncounttotal: Long = 92000\ncorrect: Long = 84711\nwrong: Long = 7289\ntruep: Double = 0.92075\ntruen: Double = 2.173913043478261E-5\nfalsen: Double = 0.07921739130434782\nfalsep: Double = 1.0869565217391305E-5\nratioWrong: Double = 0.07922826086956522\nratioCorrect: Double = 0.9207717391304348\nprecision: Double = 0.9999881950182977\nrecall: Double = 0.9207800254356121\nfmeasure: Double = 0.9587509266752308\n"}]},"apps":[],"jobName":"paragraph_1551921357357_354140222","id":"20181015-224231_2027590368","dateCreated":"2019-03-07T01:15:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:16022","dateFinished":"2019-03-07T01:44:51+0000","dateStarted":"2019-03-07T01:44:44+0000","runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://a4a0c1839040:4040/jobs/job?id=73","http://a4a0c1839040:4040/jobs/job?id=74","http://a4a0c1839040:4040/jobs/job?id=75","http://a4a0c1839040:4040/jobs/job?id=76","http://a4a0c1839040:4040/jobs/job?id=77","http://a4a0c1839040:4040/jobs/job?id=78","http://a4a0c1839040:4040/jobs/job?id=79"],"interpreterSettingId":"spark"}}},{"text":"//writedb.stop()","user":"anonymous","dateUpdated":"2019-03-07T01:15:57+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551921357358_951972255","id":"20171122-091021_1615582434","dateCreated":"2019-03-07T01:15:57+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:16024"}],"name":"FlightStructuredStreaming","id":"2E66VT81J","noteParams":{},"noteForms":{},"angularObjects":{},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}